/*!
 * ZUI - v1.2.1 - 2015-04-15
 * http://zui.sexy
 * GitHub: https://github.com/easysoft/zui.git 
 * Copyright (c) 2015 cnezsoft.com; Licensed MIT
 */

!function(a,b){"use strict";String.prototype.endsWith||(String.prototype.endsWith=function(a,b){var c=this.toString();(void 0===b||b>c.length)&&(b=c.length),b-=a.length;var d=c.indexOf(a,b);return-1!==d&&d===b}),String.prototype.startsWith||(String.prototype.startsWith=function(a,b){return b=b||0,this.lastIndexOf(a,b)===b}),String.prototype.includes||(String.prototype.includes=function(){return-1!==String.prototype.indexOf.apply(this,arguments)});var c=!1,d=1;d&&console.error("DEBUG ENABLED.");var e={start:{col:1},basic:{col:1},control:{col:2},component:{col:2},javascript:{col:3},view:{col:3}},f="lastReloadAnimate",g="LAST_QUERY_ID",h="index.json",i=void 0,j={"index.json":null};d&&(a.dataset=j);var k,l,m,n,o,p,q,r,s,t,u,v=function(a,e,f){var g=j[a],h=null===g;if(h&&(g=b.store.get(a,null),j[a]=g,null!==g&&(d&&console.log("Load data from storage: ",a,"=",g),e(g))),null===g||f||h||!c){var i=a.endsWith(".json")?"json":"html";b.get(a,function(c){if(!d&&null!==g){if("json"===i&&b.isPlainObject(c)&&g.version&&c.version&&c.version===g.version)return;if("html"===i&&g===c)return}j[a]=c,d&&console.log("Load data from remote: ",a,"=",c),e(c),b.store.set(a,c)},i)}},w=function(a,c){var d=j[h];return d?(b.each(e,function(e,f){if(d.chapters[e]){b.extend(f,d.chapters[e]);var g=f.sections,h=null;return c&&(h=c(f,g),h===!1)?!1:void b.each(g,function(b,c){return a(f,c,h)===!1?!1:void 0})}}),!0):(console.error("Document index is empty."),!1)},x=function(){w(function(a,b,c){var d=a.id,e=n.clone().attr("id","section-"+d+"-"+b.id);e.attr("data-id",b.id);var f=e.children(".card-heading");f.find(".name").text(b.name),f.children(".desc").text(b.desc);var g=f.children(".icon");(void 0===b.icon||null===b.icon||""===b.icon)&&(b.icon=b.name.substr(0,1).toUpperCase()),0===b.icon.indexOf("icon-")?g.addClass(b.icon):g.addClass("text-icon").text(b.icon);var h=e.find(".topics");if(b.topics&&b.topics.length)for(var i in b.topics){var j=b.topics[i];j.id=i,h.append('<li data-id="'+i+'">'+j.name+"</li>")}else h.remove(".card-content"),e.addClass("without-topics");c.append(e.addClass("show"))},function(a,b){var c=a.$sections;return c.children().remove(),c})?(clearTimeout(m.data(f)),m.data(f,setTimeout(function(){t=m.find(".section").addClass("in"),u.addClass("in")},100))):d&&console.error("Display sections failed.")},y=function(a){t&&(t.removeClass("choosed open"),a&&a.hasClass("section")&&(r=a.addClass("choosed open")))},z=function(){q.removeClass("hide"),p.removeClass("hide"),t.addClass("show"),u.addClass("show"),m.data(f,setTimeout(function(){t.addClass("in"),u.addClass("in")},20)),k.removeClass("query-enabled")},A=function(a){if(t){if(o.data("queryString")!==a&&(o.data("queryString",a).val(a),m.css("min-height",m.height())),a===i||null===a||!a.length)return void z();k.addClass("query-enabled");var c=[];if(b.each(a.split(" "),function(a,d){d=b.trim(d).toLowerCase();var f={origin:d};d.startsWith("#")?(f.type="id",f.val=d.substr(1)):d.startsWith("icon-")||d.startsWith("icon:")?(f.type="icon",f.val=d.substr(5)):d.startsWith("i:")?(f.type="icon",f.val=d.substr(1)):d.startsWith("ver:")?(f.type="version",f.val=d.substr(4)):d.startsWith("v:")?(f.type="version",f.val=d.substr(2)):d.startsWith("version:")?(f.type="version",f.val=d.substr(8)):d.startsWith("grunt:")||d.startsWith("build:")?(f.type="build",f.val=d.substr(6)):d.startsWith("g:")||d.startsWith("b:")?(f.type="build",f.val=d.substr(2)):(b.each(e,function(a){return d.startsWith(a+":")?(f.type="id",f.chapter=a,f.val=d.substr(a.length),!1):void 0}),f.type||(f.type="any",f.val=d)),f.val.length&&c.push(f)}),!c.length)return void z();var f,g,h,j,n,p,r,u={},v={};if(w(function(a,d){h=!0,p=[],f=0,b.each(c,function(c,e){switch(n=e.val,r=null,j=!1,e.type){case"id":j=(e.chapter?a:d).id.includes(n),j&&(r=[e.chapter?"chapter":"section","id"]),f=100;break;case"icon":j="icons"===d.id,j&&(r=["section","id"]),f=100;break;default:if(d.name.toLowerCase().includes(n)){j=!0,r=["section","name"],f=80;break}if(a.name.toLowerCase().includes(n)){j=!0,r=["chapter","name"],f=70;break}if(n.length>1){if(d.id.includes(n)){j=!0,r=["section","id"],f=65;break}if(a.id.includes(n)){j=!0,r=["chapter","id"],f=60;break}if(b.isArray(d.topics)){var g=!1;if(b.each(d.topics,function(a,b){return b.name&&b.name.toLowerCase().includes(n)?(j=!0,r=["section","topic",a],g=!0,f=20,!1):void 0}),g)break}if(d.desc.toLowerCase().includes(n)){j=!0,r="section.desc",f=30;break}}else{if(a.id.startsWith(n)){j=!0,r=["chapter","id"],f=60;break}if(d.id.startsWith(n)){j=!0,r=["section","id"],f=50;break}}}return j?void p.push({key:e,type:r}):(h=!1,!1)}),g=a.id+"-"+d.id,h?(v[a.id]++,u[g]={hidden:!1,matches:p,weight:f}):u[g]={hidden:!0}},function(a){v[a.id]=0})){var x,A,B=b(),C=b(),D=-1;b.each(u,function(a,c){x=b("#section-"+a),c.hidden?B=B.add(x):(C=C.add(x),D<c.weight&&(A=x,D=c.weight)),y(A)});var E,F;b.each(v,function(a,b){F=e[a],E=!b,F.$.toggleClass("hide",E)});var G,H=0;q.each(function(){G=b(this);var a=G.children(".chapter:not(.hide)").length;if(G.toggleClass("hide",!a),a&&(H++,!k.hasClass("compact-mode"))){var c=G.find(".section:not(.hide)").length;c>2&&l.height()<s.height()+70*c&&(k.addClass("compact-mode"),setTimeout(function(){l.scrollTop(1),k.addClass("compact-mode-in")},10))}}),m.attr("data-show-col",H),B.length&&(B.removeClass("in"),setTimeout(function(){B.removeClass("show")},100)),C.length&&(C.addClass("show"),setTimeout(function(){C.addClass("in")},20))}else d&&console.error("Query failed with key: ",c)}};b(function(){var c=function(a){a.stopPropagation()};l=b(a),k=b("body"),m=b("#grid"),s=b("#header"),q=m.find(".col"),p=m.find(".chapter"),o=b("#searchInput"),u=m.find(".chapter-heading"),n=b("#sectionTemplate").attr("id",null),b.each(e,function(a,c){a=a.toLowerCase(),c.$=b("#chapter-"+a),c.id=a,c.$sections=b("#sections-"+a)}),v(h,x),b(document).on("click",function(){y(),t.removeClass("open")}),m.on("click",".card-heading",function(a){var c=b(this).closest(".card");c.hasClass("without-topics")?c.find(".btn-toggle").trigger("click"):c.toggleClass("open")}).on("click",".card",function(a){y(b(this)),a.stopPropagation()}).on("mouseenter",".card-heading > h5 > .name, .card-heading > .icon",function(){b(this).closest(".card-heading").addClass("hover")}).on("mouseleave",".card-heading > h5 > .name, .card-heading > .icon",function(){b(this).closest(".card-heading").removeClass("hover")});var d,f=b("#navbar").outerHeight(),i=!1;l.on("scroll",function(a){i&&l.scrollTop(d),d=l.scrollTop(),d>f&&!k.hasClass("compact-mode")?(i=!0,k.addClass("compact-mode"),setTimeout(function(){l.scrollTop(1),k.addClass("compact-mode-in"),i=!1},10)):k.hasClass("compact-mode")&&(1>d?(i=!0,k.removeClass("compact-mode-in"),setTimeout(function(){k.removeClass("compact-mode"),i=!1},500)):s.toggleClass("with-shadow",d>20))}),o.on("change keyup paste input propertychange",function(){var a=o.val();a!==o.data("queryString")&&(clearTimeout(o.data(g)),o.data(g,setTimeout(function(){A(a)},150)))}).on("focus",function(){k.addClass("input-query-focus"),o.val()&&!t.filter(".open").length&&y(t.filter(".show:first"))}).on("blur",function(){k.removeClass("input-query-focus")}).on("click",c)})}(window,jQuery);