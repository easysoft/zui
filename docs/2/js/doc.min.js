/*!
 * ZUI - v1.3.0 - 2015-04-20
 * http://zui.sexy
 * GitHub: https://github.com/easysoft/zui.git 
 * Copyright (c) 2015 cnezsoft.com; Licensed MIT
 */

!function(a,b){"use strict";String.prototype.endsWith||(String.prototype.endsWith=function(a,b){var c=this.toString();(void 0===b||b>c.length)&&(b=c.length),b-=a.length;var d=c.indexOf(a,b);return-1!==d&&d===b}),String.prototype.startsWith||(String.prototype.startsWith=function(a,b){return b=b||0,this.lastIndexOf(a,b)===b}),String.prototype.includes||(String.prototype.includes=function(){return-1!==String.prototype.indexOf.apply(this,arguments)});var c=1;c&&console.error("DEBUG ENABLED.");var d,e,f={learn:{col:1},start:{col:1},basic:{col:1},control:{col:2},component:{col:2},javascript:{col:3},view:{col:3}},g="lastReloadAnimate",h="LAST_QUERY_ID",i="index.json",j=void 0,k="page-show-full",l={};c&&(a.dataset=l);var m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E=-1,F=1120,G=function(b){var c=new RegExp("(^|&)"+b+"=([^&]*)(&|$)","i"),d=a.location.search.substr(1).match(c);return null!=d?unescape(d[2]):null},H=function(){if(!(document.body.clientWidth>=a.innerWidth)){if(0>E){var b=document.createElement("div");b.className="modal-scrollbar-measure",n.append(b),E=b.offsetWidth-b.clientWidth,n[0].removeChild(b)}if(E){var c=parseInt(n.css("padding-right")||0,10);n.css("padding-right",c+E),A.css("padding-right",E)}}},I=function(){n.css("padding-right",""),A.css("padding-right","")},J=function(a,f){var g=l[a],h=g&&g.version,j=a===i;if(!h&&e){var k=b.store.get("//"+a,null);if(null!==k){var m=b.store.get("//"+a+"::V");m&&(g={data:k,version:m},l[a]=g,h=!0,c&&console.log("Load",a,"from storage:",g))}}if(!h||!j&&g.version!==d||(c&&console.log("Load",a,"from cache:",g),f(g.data),j)){var n=a.endsWith(".json")?"json":"html";b.get(a,function(e){null!==e?(j&&(d=e.version),g={data:e,version:d},l[a]=g,b.store.set("//"+a,e),b.store.set("//"+a+"::V",d),c&&console.log("Load",a,"from remote:",g),f(e)):h&&!j&&(c&&console.log("Failed load",a,"from remote, instead load cache:",g),f(g.data))},n).error(function(){c&&console.error("Ajax error:",a),h&&!j&&(c&&console.log("Failed load",a,"from remote with error, instead load cache:",g),f(g.data))})}},K=function(a,c){var d=l[i].data;return d?(b.each(f,function(e,f){if(d.chapters[e]){b.extend(f,d.chapters[e]);var g=f.sections,h=null;return c&&(h=c(f,g),h===!1)?!1:void b.each(g,function(b,c){return a(f,c,h)===!1?!1:void 0})}}),!0):(console.error("Document index is empty."),!1)},L=function(a,b){a.attr("class","icon").text(""),(void 0===b.icon||null===b.icon||""===b.icon)&&(b.icon=b.name.substr(0,1).toUpperCase()),0===b.icon.indexOf("icon-")?a.addClass(b.icon):a.addClass("text-icon").text(b.icon)},M=function(){var a=0;K(function(b,c,d){var e=b.id;c.chapter=e;var f=e+"-"+c.id,g=q.clone().attr("id","section-"+f).data("section",c);g.attr("data-id",c.id).attr("data-chapter",e).attr("data-order",a++);var h=g.children(".card-heading");h.find(".name").text(c.name).attr("href","#"+f),h.children(".desc").text(c.desc),L(h.children(".icon"),c);var i=g.find(".topics");if(c.topics&&c.topics.length)for(var j in c.topics){var k=c.topics[j];k.id=j,i.append('<li data-id="'+j+'">'+k.name+"</li>")}else i.remove(".card-content"),g.addClass("without-topics");d.append(g.addClass("show"+(m?" in":"")))},function(a,b){var c=a.$sections;return c.children().remove(),c})?(n.children(".loader").removeClass("loading"),C=p.find(".section"),m||(clearTimeout(p.data(g)),p.data(g,setTimeout(function(){C.addClass("in"),D.addClass("in")},100)),m=!0)):c&&console.error("Display sections failed.")},N=function(a,b,c){a===j&&(a=n),b===j||"down"===b?b=a.scrollTop()+.8*(o.height()-a.offset().top):"up"===b&&(b=a.scrollTop()-.8*(o.height()-a.offset().top)),a.animate({scrollTop:b},200,"swing",c)},O=function(a){if(a){a.offset().top,a.outerHeight(),o.height(),n.scrollTop()}},P=function(a){return a===j&&(a=u),a&&a.hasClass("choosed")&&a.hasClass("show")},Q=function(a,b,c){if(C){if(P(a||null)&&!c)return u=a.addClass("open"),void O(a);var d=a&&a.hasClass("open");C.removeClass(b?"choosed":"choosed open"),a&&a.hasClass("section")&&(u=a.addClass(c&&!d?"choosed":"choosed open"),O(a))}},R=function(){var a=C.filter(".show");if(P()){for(var b=parseInt(u.data("order")),c=u;--b>-1;){var d=a.filter('[data-order="'+b+'"]');if(d.length){c=d;break}}Q(c)}else Q(a.first())},S=function(){var a=C.filter(".show");if(P()){for(var b=parseInt(u.data("order")),c=u,d=C.length;b++<d;){var e=a.filter('[data-order="'+b+'"]');if(e.length){c=e;break}}Q(c)}else Q(a.first())},T=function(a,b,c,d){return Math.sqrt(Math.pow(a-c,2)+Math.pow(b-d,2),2)},U=function(){var a=C.filter(".show");if(P()){var c=u.offset(),d=c.left-p.children(".container").offset().left-10;if(50>d)return void R();var e=c.top;d=c.left;var f=u,g=99999;a.each(function(){var a=b(this),c=a.offset();if(c.left+50<d){var h=T(c.left,c.top,d,e);g>h&&(f=a,g=h)}}),Q(f)}else Q(a.first())},V=function(){var a=C.filter(".show");if(P()){var c=u.offset(),d=p.children(".container"),e=c.left-d.offset().left-10;if(e+20+u.outerWidth()+50>=d.outerWidth())return void S();var f=c.top;e=c.left;var g=u,h=99999;a.each(function(){var a=b(this),c=a.offset();if(c.left>e){var d=T(c.left,c.top,e,f);h>d&&(g=a,h=d)}}),Q(g)}else Q(a.first())},W=function(){t.removeClass("hide"),s.removeClass("hide"),C.addClass("show"),D.addClass("show"),p.data(g,setTimeout(function(){C.addClass("in"),D.addClass("in")},20)),n.removeClass("query-enabled")},X=function(a){if(!C)return void(c&&console.log("Query failed, $sections is empty. key:",a));if(r.data("queryString")!==a&&(r.data("queryString",a).val(a),p.css("min-height",p.height())),a===j||null===a||!a.length)return void W();n.addClass("query-enabled");var d=[];if(b.each(a.split(" "),function(a,c){c=b.trim(c).toLowerCase();var e={origin:c};c.startsWith("#")?(e.type="id",e.val=c.substr(1)):c.startsWith("icon-")||c.startsWith("icon:")?(e.type="icon",e.val=c.substr(5)):c.startsWith("i:")?(e.type="icon",e.val=c.substr(1)):c.startsWith("ver:")?(e.type="version",e.val=c.substr(4)):c.startsWith("v:")?(e.type="version",e.val=c.substr(2)):c.startsWith("version:")?(e.type="version",e.val=c.substr(8)):c.startsWith("grunt:")||c.startsWith("build:")?(e.type="build",e.val=c.substr(6)):c.startsWith("g:")||c.startsWith("b:")?(e.type="build",e.val=c.substr(2)):(b.each(f,function(a){return c.startsWith(a+":")?(e.type="id",e.chapter=a,e.val=c.substr(a.length),!1):void 0}),e.type||(e.type="any",e.val=c)),e.val.length&&d.push(e)}),!d.length)return void W();var e,g,h,i,k,l,m,q={},s={};if(K(function(a,c){h=!0,l=[],e=0,b.each(d,function(d,f){switch(k=f.val,m=null,i=!1,f.type){case"id":i=(f.chapter?a:c).id.includes(k),i&&(m=[f.chapter?"chapter":"section","id"]),e=100;break;case"icon":i="icons"===c.id,i&&(m=["section","id"]),e=100;break;default:if(c.name.toLowerCase().includes(k)){i=!0,m=["section","name"],e=80;break}if(a.name.toLowerCase().includes(k)){i=!0,m=["chapter","name"],e=70;break}if(k.length>1){if(c.id.includes(k)){i=!0,m=["section","id"],e=65;break}if(a.id.includes(k)){i=!0,m=["chapter","id"],e=60;break}if(b.isArray(c.topics)){var g=!1;if(b.each(c.topics,function(a,b){return b.name&&b.name.toLowerCase().includes(k)?(i=!0,m=["section","topic",a],g=!0,e=20,!1):void 0}),g)break}if(c.desc.toLowerCase().includes(k)){i=!0,m="section.desc",e=30;break}}else{if(a.id.startsWith(k)){i=!0,m=["chapter","id"],e=60;break}if(c.id.startsWith(k)){i=!0,m=["section","id"],e=50;break}}}return i?void l.push({key:f,type:m}):(h=!1,!1)}),g=a.id+"-"+c.id,h?(s[a.id]++,q[g]={hidden:!1,matches:l,weight:e}):q[g]={hidden:!0}},function(a){s[a.id]=0})){var u,v,w=b(),x=b(),y=-1;b.each(q,function(a,c){u=b("#section-"+a),c.hidden?w=w.add(u):(x=x.add(u),y<c.weight&&(v=u,y=c.weight)),Q(v)});var z,A;b.each(s,function(a,b){A=f[a],z=!b,A.$.toggleClass("hide",z)});var D,E=0;t.each(function(){D=b(this);var a=D.children(".chapter:not(.hide)").length;if(D.toggleClass("hide",!a),a&&(E++,!n.hasClass("compact-mode"))){var c=D.find(".section:not(.hide)").length;c>2&&o.height()<B.height()+70*c&&(n.addClass("compact-mode"),setTimeout(function(){o.scrollTop(1),n.addClass("compact-mode-in")},10))}}),p.attr("data-show-col",E),w.length&&(w.removeClass("in"),setTimeout(function(){w.removeClass("show")},100)),x.length&&(x.addClass("show"),setTimeout(function(){x.addClass("in")},20)),o.scrollTop(1),Z()}else c&&console.error("Query failed with key: ",d)},Y=function(a,b){a===j&&(a=!n.hasClass("compact-mode"));var c="isScrollAnimating";a?n.hasClass("compact-mode")?b&&b():(n.data(c,!0).addClass("compact-mode"),setTimeout(function(){n.addClass("compact-mode-in"),o.scrollTop(1),setTimeout(function(){n.data(c,!1),b&&b()},500)},10)):n.hasClass("compact-mode")?(n.data(c,!0).removeClass("compact-mode-in"),setTimeout(function(){n.removeClass("compact-mode"),n.data(c,!1),b&&b()},500)):b&&b()},Z=function(){if(n.hasClass("page-open")){var a=v.data("trans-style");return a["max-height"]="",v.css(a),n.addClass("page-show-out").removeClass("page-open page-show-in"),setTimeout(function(){n.removeClass("page-show page-show-out"),I()},300),!0}return!1},$=function(b,d,e){var f=d.chapter+"-"+d.id;if(n.hasClass("page-open")&&f===n.attr("data-page"))return void(c&&console.error("The page already showed."));Q(b,!1,!0),a.location.hash="#"+f,n.attr("data-page-chapter",d.chapter).attr("data-page",f),L(w.find(".icon"),d),w.find(".name").text(d.name).attr("href","#"+d.chapter+"-"+d.id),w.children(".desc").text(d.desc),x.html("");var g=v.addClass("loading").find(".loader").addClass("loading");return J(d.url,function(a){v.removeClass("loading"),g.removeClass("loading"),x.html(a),r.blur(),z.scrollTop(0)}),n.hasClass("page-open")?void(c&&console.log("open section in open page",d)):(n.addClass("page-open"),void Y(!0,function(){var a=b.offset(),c=b.outerHeight(),d={left:a.left-p.children(".container").offset().left-6,top:a.top-o.scrollTop()-81,width:b.outerWidth(),height:c,"max-height":c};H(),n.addClass("page-show"),v.css(d).data("trans-style",d),z.css("width",F),setTimeout(function(){n.addClass("page-show-in"),v.hasClass("loading")&&v.addClass("openning").css("height",380),z.scrollTop(0),setTimeout(function(){v.removeClass("openning"),F=z.css("width","").width()+40,aa()},310)},10)}))},_=function(d,e){d=d||u;var f;if(b.isArray(d)){var g=l[i].data;if(!(g&&d.length>1))return void(c&&console.error("Open section stop by null docIndex or wrong section value."));var h=d[1],j=g.chapters[d[0]].sections,k=!1;for(var m in j){var n=j[m];if(n.id===h){d.length>2&&(e=d[2]),d=n,k=!0;break}}if(!k)return void console.error("Open section failed: can't find the section with id "+d.join("-"))}if(b.isPlainObject(d))f=b("#section-"+d.chapter+"-"+d.id);else{var o=d;d=o.data("section"),f=o}var p=d.url;return null===p?void(c&&console.error("Open section stop by null url.")):(p||(p="part/"+d.chapter+"-"+d.id+".html",d.url=p),p=p.toLowerCase(),void(p.startsWith("http://")||p.startsWith("https://")?a.open(p,"_blank"):$(f,d,e)))};a.openS=_;var aa=function(){if(!n.hasClass("page-show-out")&&!v.hasClass("loading")){var a;n.hasClass(k)?(a=o.height(),z.toggleClass("with-scrollbar",x.outerHeight()>a-40-w.outerHeight())):a=Math.min(y.outerHeight(),w.outerHeight()+x.outerHeight()+50),v.css("height",a)}};b(function(){var c=function(a){a.stopPropagation()};o=b(a),n=b("body"),A=b("#navbar"),p=b("#grid"),B=b("#header"),t=p.find(".col"),v=b("#page"),w=b("#pageHeader"),y=b("#pageContainer"),x=b("#pageContent"),s=p.find(".chapter"),r=b("#searchInput"),D=p.find(".chapter-heading"),q=b("#sectionTemplate").attr("id",null),z=b("#pageBody"),b.each(f,function(a,c){a=a.toLowerCase(),c.$=b("#chapter-"+a),c.id=a,c.$sections=b("#sections-"+a)}),F=p.children(".container").outerWidth(),n.toggleClass(k,b.store.get(k,!1)),e=b.store&&b.store.enable,b.ajaxSetup({cache:!1}),J(i,function(b){var c=!m;if(M(b),!c){var d=G("q");d&&setTimeout(function(){X(d)},300);var e=a.location.hash;e?(e=e.substr(1),setTimeout(function(){_(e.split("-"))},600)):r.focus()}}),b(document).on("click",function(a){return n.hasClass("page-show")?void Z():(Q(),void C.removeClass("open"))}),v.on("click",c),p.on("click",".card-heading",function(a){var d=b(this).closest(".card");d.hasClass("choosed")?d.toggleClass("open"):Q(d,!0),c(a)}).on("click",".card",function(a){Q(b(this),!0),c(a)}).on("click",".card-heading > h5 > .name, .card-heading > .icon",function(a){_(b(this).closest(".section")),c(a)}).on("click",".topics > li",function(a){var d=b(this);_(d.closest(".section"),d.data("id")),c(a)}).on("mouseenter",".card-heading > h5 > .name, .card-heading > .icon",function(){b(this).closest(".card-heading").addClass("hover")}).on("mouseleave",".card-heading > h5 > .name, .card-heading > .icon",function(){b(this).closest(".card-heading").removeClass("hover")}),x.on("resize",aa),o.resize(aa),w.on("click",".path-close-btn",function(){Z()}).on("click",".path-max-btn",function(){n.toggleClass(k),setTimeout(aa,300),b.store.set(k,n.hasClass(k))});var d,g=b("#navbar").outerHeight();o.on("scroll",function(a){var b=n.data("isScrollAnimating");return b?void o.scrollTop(1):(d=o.scrollTop(),void(d>g&&!n.hasClass("compact-mode")?Y(!0):n.hasClass("compact-mode")&&(1>d?Y(!1):B.toggleClass("with-shadow",d>20))))}).on("keydown",function(a){var b=a.which,c=!n.hasClass("page-show");13===b?c&&P()&&_():27===b?Z()||n.hasClass("input-query-focus")&&X():32===b?(Z()||(n.hasClass("compact-mode")?P()&&_():Y(!0)),a.preventDefault()):37===b?(U(),a.preventDefault()):39===b?(V(),a.preventDefault()):38===b?c?(R(),a.preventDefault()):N(z,"up"):40===b&&(c?(S(),a.preventDefault()):N(z),a.preventDefault())}),z.on("scroll",function(a){v.toggleClass("with-shadow",z.scrollTop()>20)}),r.on("change keyup paste input propertychange",function(){var a=r.val();a!==r.data("queryString")&&(clearTimeout(r.data(h)),r.data(h,setTimeout(function(){X(a)},150)))}).on("focus",function(){n.addClass("input-query-focus"),r.val()&&!C.filter(".open").length&&Q(C.filter(".show:first"))}).on("blur",function(){n.removeClass("input-query-focus")}).on("click",c),b('[data-toggle="tooltip"]').tooltip({container:"body"})})}(window,jQuery);