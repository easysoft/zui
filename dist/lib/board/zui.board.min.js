/*!
 * ZUI - v1.4.0 - 2016-01-26
 * http://zui.sexy
 * GitHub: https://github.com/easysoft/zui.git 
 * Copyright (c) 2016 cnezsoft.com; Licensed MIT
 */

!function(t){"use strict";if(!t.fn.droppable)throw new Error("Droppable requires for boards");var o=function(o,i){this.$=t(o),this.options=this.getOptions(i),this.getLang(),this.init()};o.DEFAULTS={lang:"zh-cn",langs:{"zh-cn":{append2end:"移动到末尾"},"zh-tw":{append2end:"移动到末尾"},en:{append2end:"Move to the end."}}},o.prototype.getOptions=function(i){return i=t.extend({},o.DEFAULTS,this.$.data(),i)},o.prototype.getLang=function(){var i=window.config;if(!this.options.lang){if("undefined"!=typeof i&&i.clientLang)this.options.lang=i.clientLang;else{var n=t("html").attr("lang");this.options.lang=n?n:"en"}this.options.lang=this.options.lang.replace(/-/,"_").toLowerCase()}this.lang=this.options.langs[this.options.lang]||this.options.langs[o.DEFAULTS.lang]},o.prototype.init=function(){var o=1,i=this.lang;this.$.find('.board-item:not(".disable-drop"), .board:not(".disable-drop")').each(function(){var n=t(this);n.attr("id")?n.attr("data-id",n.attr("id")):n.attr("data-id")||n.attr("data-id","board"+o++),n.hasClass("board")&&n.find(".board-list").append('<div class="board-item board-item-empty"><i class="icon-plus"></i> {append2end}</div>'.format(i)).append('<div class="board-item board-item-shadow"></div>'.format(i))}),this.bind()},o.prototype.bind=function(o){var i=this.$,n=this.options;"undefined"==typeof o&&(o=i.find('.board-item:not(".disable-drop, .board-item-shadow")')),o.droppable({before:n.before,target:'.board-item:not(".disable-drop, .board-item-shadow")',flex:!0,start:function(t){i.addClass("dragging").find(".board-item-shadow").height(t.element.outerHeight())},drag:function(t){if(i.find(".board.drop-in-empty").removeClass("drop-in-empty"),t.isIn){var o=t.target.closest(".board").addClass("drop-in"),n=o.find(".board-item-shadow"),a=t.target;i.addClass("drop-in").find(".board.drop-in").not(o).removeClass("drop-in"),n.insertBefore(a),o.toggleClass("drop-in-empty",a.hasClass("board-item-empty"))}},drop:function(o){if(o.isNew){var i,a="drop";n.hasOwnProperty(a)&&t.isFunction(n[a])&&(i=n[a](o)),i!==!1&&o.element.insertBefore(o.target)}},finish:function(){i.removeClass("dragging").removeClass("drop-in").find(".board.drop-in").removeClass("drop-in")}})},t.fn.boards=function(i){return this.each(function(){var n=t(this),a=n.data("zui.boards"),e="object"==typeof i&&i;a||n.data("zui.boards",a=new o(this,e)),"string"==typeof i&&a[i]()})},t.fn.boards.Constructor=o,t(function(){t('[data-toggle="boards"]').boards()})}(jQuery);